---
/**
 * WatermarkBackground.astro
 * 
 * A full-page tiled wallpaper pattern that creates the layered effect from the
 * original Physica Medica site. The pattern (Lion + PHYSICA + MEDICA) tiles
 * across the entire viewport, stays fixed, and shows through transparent/gray
 * sections while being covered by solid-colored sections.
 * 
 * Props:
 * - variant: 'gray' | 'teal' (default: 'gray')
 * - angle: number in degrees (default: 0)
 */

interface Props {
  variant?: 'gray' | 'teal';
  angle?: number;
}

const { variant = 'gray', angle = 0 } = Astro.props;

// Colors based on variant
const isTeal = variant === 'teal';
const patternFill = isTeal ? 'rgba(255,255,255,0.12)' : 'rgba(0,0,0,0.12)';
const logoFilter = isTeal ? 'brightness(100) opacity(0.12)' : 'brightness(0) opacity(0.12)';
const bgGradient = isTeal 
  ? 'linear-gradient(135deg, #2d6d5f, #1f4d42)' 
  : 'linear-gradient(to bottom, #e0e0e0, #d0d0d0)';

// Generate unique pattern ID to avoid conflicts when multiple instances exist
const patternId = `watermark-pattern-${variant}-${angle}`;
---

<div 
  class="watermark-background" 
  aria-hidden="true"
  style={`background: ${bgGradient};`}
>
  <svg 
    xmlns="http://www.w3.org/2000/svg" 
    width="100%" 
    height="100%"
    style={angle !== 0 ? `transform: rotate(${angle}deg) scale(1.3); transform-origin: center center;` : ''}
  >
    <defs>
      <!-- The repeating tile pattern -->
      <pattern id={patternId} x="0" y="0" width="400" height="500" patternUnits="userSpaceOnUse">
        <!-- Tile unit: Lion (cropped from logo) + PHYSICA below + MEDICA below that -->
        
        <!-- Lion logo - use viewBox to crop to just the center shield/lion -->
        <svg x="100" y="20" width="200" height="200" viewBox="177 25 1 110" preserveAspectRatio="xMidYMid meet">
          <image 
            href="/images/Physica-Medica-logo.jpg" 
            x="0" 
            y="0"
            width="354" 
            height="161"
            style={`filter: ${logoFilter};`}
          />
        </svg>
        
        <!-- PHYSICA text - centered below lion -->
        <text 
          x="200" 
          y="280" 
          text-anchor="middle" 
          font-family="-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"
          font-size="48" 
          font-weight="300"
          letter-spacing="0.3em" 
          fill={patternFill}
        >PHYSICA</text>
        
        <!-- MEDICA text - centered below PHYSICA -->
        <text 
          x="200" 
          y="340" 
          text-anchor="middle"
          font-family="-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"
          font-size="48"
          font-weight="300"
          letter-spacing="0.3em"
          fill={patternFill}
        >MEDICA</text>
      </pattern>
    </defs>
    
    <!-- Fill the entire SVG with the pattern -->
    <rect width="100%" height="100%" fill={`url(#${patternId})`} />
  </svg>
</div>

<style>
  .watermark-background {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 0;
    overflow: hidden;
  }

  .watermark-background svg {
    width: 100%;
    height: 100%;
    display: block;
  }

  /* Hide on very small screens for cleaner mobile experience */
  @media (max-width: 600px) {
    .watermark-background svg {
      opacity: 0.5;
    }
  }
</style>
